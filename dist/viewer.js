(()=>{var e={171:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChunksToLinesTransform=function(){let e="";return new TransformStream({transform:(t,n)=>{const s=e+t;e="";const r=s.split(/\r?\n/g);for(;r.length>1;)n.enqueue(r.shift());const i=r.shift();i&&(e=i)}})}},337:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processChatMessage=function(e,t){const n=t.replayChatItemAction?.actions[0].addChatItemAction?.item;if(!n)return!1;let s,i="",d="",m=!1,f=!1,p="",g="",M=0,y=!1,$=!1,C=!1,b=0,S=!1;if(n.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer){const e=n.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer,t=e.header.liveChatSponsorshipsHeaderRenderer;t.authorExternalChannelId=e.authorExternalChannelId,C=!0,b=parseInt((t.primaryText.runs||[])[1].text||"0"),s=l(t),d+=function(e){let t='<span class="msg membership-gift system-message">';return t+='<span class="gift-icon">üéÅ</span>',t+=`<span class="text">${u(e)}</span>`,t+="</span>",t}(t.primaryText)}else if(n.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer){const e=n.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer;s=l(e),d+=h(e.message,["membership-received","system-message"]),S=!0}else if(n.liveChatMembershipItemRenderer){const e=n.liveChatMembershipItemRenderer;s=l(e),e.message?(d+=function(e,t){let n='<span class="msg membership-message">';return n+=`<span class="mem-length">${function(e){return u(e).replace(/^[^0-9]+/,"").replace(/months?/,"mo").replace(/years?/,"yr")}(e)}</span>`,n+=`<span class="text">${u(t)}</span>`,n+="</span>",n}(e.headerPrimaryText,e.message),i=u(e.message),$=!0):(d+=h(e.headerSubtext,["membership-join","system-message"]),y=!0)}else if(n.liveChatPaidMessageRenderer){const e=n.liveChatPaidMessageRenderer,{currencyLabel:t,amount:r}=c(e.purchaseAmountText);p=a(e.bodyBackgroundColor),M=r,g=t,m=!0,s=l(e),d+=function(e,t){let n=`<span class="msg superchat ${t}">`;return n+=`<span class="money">${u(e.purchaseAmountText)}</span>`,e.message&&(n+=`<span class="text">${u(e.message)}</span>`),n+="</span>",n}(e,p),i=u(e.message||"")}else if(n.liveChatPaidStickerRenderer){const e=n.liveChatPaidStickerRenderer,{currencyLabel:t,amount:r}=c(e.purchaseAmountText);p=a(e.backgroundColor),M=r,g=t,f=!0,s=l(e),d+=function(e,t){const n=o(e.sticker.thumbnails),s=e.sticker.accessibility.accessibilityData.label;let r=`<span class="msg super-sticker ${t}">`;return r+=`<span class="money">${u(e.purchaseAmountText)}</span>`,n&&(r+=`<img class="sticker" src="${n.url}" alt="${s}">`),r+="</span>",r}(e,p)}else{if(!n.liveChatTextMessageRenderer)return!1;{const e=n.liveChatTextMessageRenderer;s=l(e),d+=h(e.message),i=u(e.message||"")}}let v="";return v+=function(e){const t=parseInt(e,10)||0,n=t>36e5?"H:mm:ss":"mm:ss";return`<span class="time offset">${r.default.duration(t).format(n)}</span>`}(t.replayChatItemAction?.videoOffsetTimeMsec||""),v+=function(e){return`<span class="${["user",...e.cssClasses].join(" ")}">\n            <a href="https://www.youtube.com/channel/${e.channelId}">${e.name}</a>\n        </span>\n    `}(s),v+=d,e.allChats.push({isMember:s.isMember,isMod:s.isMod,isOwner:s.isOwner,isSuperChat:m,isSuperSticker:f,superColour:p,superCurrency:g,superValue:M,isMembershipJoin:y,isMembershipMessage:$,isMembershipGift:C,numGiftsPurchased:b,isMembershipRedemption:S,userName:s.name,textContent:i,htmlLine:v}),!0};const r=s(n(353)),i=s(n(522));function a(e){const t=e.toString(),n={4279592384:"blue",4280191205:"blue",4278237396:"light-blue",4278248959:"light-blue",4278239141:"light-green",4280150454:"light-green",4294947584:"yellow",4294953512:"yellow",4293284096:"orange",4294278144:"orange",4290910299:"pink",4293467747:"pink",4291821568:"red",4293271831:"red"};return n[t]?n[t]:"unknown"}function o(e){let t=null;for(const n of e)t?(n.width||0)<(t.width||0)&&(t=n):t=n;return t}function u(e){return"string"==typeof e?e:e.simpleText?e.simpleText:e.runs?e.runs.map(e=>e.text?e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e.emoji?function(e){if(e.isCustomEmoji){const t=o(e.image.thumbnails);return t?`<img class="emoji" src="${t.url}" alt="${e.shortcuts[0]||""}">`:`<span class="emoji-text">${e.shortcuts[0]||""}</span>`}return e.emojiId}(e.emoji):"").join(""):""}function c(e){const t=u(e).match(/^([^0-9.,]*)([0-9.,]+)/);return t?{currencyLabel:(t[1]||"Unknown").trim(),amount:parseFloat(t[2].trim())}:{currencyLabel:"Unknown",amount:0}}function l(e){const t={channelId:e.authorExternalChannelId||"",isMember:!1,isMod:!1,isOwner:!1,cssClasses:[],name:u(e.authorName||"[Unknown Name]")};for(const n of e.authorBadges||[]){const e=n.liveChatAuthorBadgeRenderer.tooltip.toLowerCase();"owner"===e?(t.isOwner=!0,t.cssClasses.push("owner")):"moderator"===e?(t.isMod=!0,t.cssClasses.push("mod")):(e.startsWith("member")||"new member"===e)&&(t.isMember=!0,t.cssClasses.push("mem"))}return t}function h(e,t=[]){const n=e?u(e):"";return`<span class="${["msg",...t].join(" ")}">${n}</span>`}r.default.extend(i.default)},353:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",s="second",r="minute",i="hour",a="day",o="week",u="month",c="quarter",l="year",h="date",d="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},g=function(e,t,n){var s=String(e);return!s||s.length>=t?e:""+Array(t+1-s.length).join(n)+e},M={s:g,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),s=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+g(s,2,"0")+":"+g(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var s=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(s,u),i=n-r<0,a=t.clone().add(s+(i?-1:1),u);return+(-(s+(n-r)/(i?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:l,w:o,d:a,D:h,h:i,m:r,s,ms:n,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",$={};$[y]=p;var C="$isDayjsObject",b=function(e){return e instanceof T||!(!e||!e[C])},S=function e(t,n,s){var r;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();$[i]&&(r=i),n&&($[i]=n,r=i);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var o=t.name;$[o]=t,r=o}return!s&&r&&(y=r),r||!s&&y},v=function(e,t){if(b(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new T(n)},w=M;w.l=S,w.i=b,w.w=function(e,t){return v(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var T=function(){function p(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[C]=!0}var g=p.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var s=t.match(m);if(s){var r=s[2]-1||0,i=(s[7]||"0").substring(0,3);return n?new Date(Date.UTC(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)):new Date(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return w},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(e,t){var n=v(e);return this.startOf(t)<=n&&n<=this.endOf(t)},g.isAfter=function(e,t){return v(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<v(e)},g.$g=function(e,t,n){return w.u(e)?this[t]:this.set(n,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var n=this,c=!!w.u(t)||t,d=w.p(e),m=function(e,t){var s=w.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return c?s:s.endOf(a)},f=function(e,t){return w.w(n.toDate()[e].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,g=this.$M,M=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case l:return c?m(1,0):m(31,11);case u:return c?m(1,g):m(0,g+1);case o:var $=this.$locale().weekStart||0,C=(p<$?p+7:p)-$;return m(c?M-C:M+(6-C),g);case a:case h:return f(y+"Hours",0);case i:return f(y+"Minutes",1);case r:return f(y+"Seconds",2);case s:return f(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var o,c=w.p(e),d="set"+(this.$u?"UTC":""),m=(o={},o[a]=d+"Date",o[h]=d+"Date",o[u]=d+"Month",o[l]=d+"FullYear",o[i]=d+"Hours",o[r]=d+"Minutes",o[s]=d+"Seconds",o[n]=d+"Milliseconds",o)[c],f=c===a?this.$D+(t-this.$W):t;if(c===u||c===l){var p=this.clone().set(h,1);p.$d[m](f),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else m&&this.$d[m](f);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[w.p(e)]()},g.add=function(n,c){var h,d=this;n=Number(n);var m=w.p(c),f=function(e){var t=v(d);return w.w(t.date(t.date()+Math.round(e*n)),d)};if(m===u)return this.set(u,this.$M+n);if(m===l)return this.set(l,this.$y+n);if(m===a)return f(1);if(m===o)return f(7);var p=(h={},h[r]=e,h[i]=t,h[s]=1e3,h)[m]||1,g=this.$d.getTime()+n*p;return w.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var s=e||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),i=this.$H,a=this.$m,o=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,h=function(e,n,r,i){return e&&(e[n]||e(t,s))||r[n].slice(0,i)},m=function(e){return w.s(i%12||12,e,"0")},p=l||function(e,t,n){var s=e<12?"AM":"PM";return n?s.toLowerCase():s};return s.replace(f,function(e,s){return s||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return o+1;case"MM":return w.s(o+1,2,"0");case"MMM":return h(n.monthsShort,o,c,3);case"MMMM":return h(c,o);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,u,2);case"ddd":return h(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return w.s(i,2,"0");case"h":return m(1);case"hh":return m(2);case"a":return p(i,a,!0);case"A":return p(i,a,!1);case"m":return String(a);case"mm":return w.s(a,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")})},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,h,d){var m,f=this,p=w.p(h),g=v(n),M=(g.utcOffset()-this.utcOffset())*e,y=this-g,$=function(){return w.m(f,g)};switch(p){case l:m=$()/12;break;case u:m=$();break;case c:m=$()/3;break;case o:m=(y-M)/6048e5;break;case a:m=(y-M)/864e5;break;case i:m=y/t;break;case r:m=y/e;break;case s:m=y/1e3;break;default:m=y}return d?m:w.a(m)},g.daysInMonth=function(){return this.endOf(u).$D},g.$locale=function(){return $[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),s=S(e,t,!0);return s&&(n.$L=s),n},g.clone=function(){return w.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},p}(),D=T.prototype;return v.prototype=D,[["$ms",n],["$s",s],["$m",r],["$H",i],["$W",a],["$M",u],["$y",l],["$D",h]].forEach(function(e){D[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),v.extend=function(e,t){return e.$i||(e(t,T,v),e.$i=!0),v},v.locale=S,v.isDayjs=b,v.unix=function(e){return v(1e3*e)},v.en=$[y],v.Ls=$,v.p={},v}()},477:(e,t)=>{"use strict";function n(){return{$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadCurrencyConversions=async function(){try{const e=await fetch("https://bcd-api-dca-ipa.cbsa-asfc.cloud-nuage.canada.ca/exchange-rate-lambda/exchange-rates"),t=await e.json(),n={};if(t.ForeignExchangeRates.forEach(e=>{if("CAD"!==e.ToCurrency.Value)return;const t=e.FromCurrency.Value,s=parseFloat(e.Rate);isNaN(s)||(n[t]=s)}),!("USD"in n))throw new Error("USD to CAD rate not found");const s=n.USD,r={};for(const[e,t]of Object.entries(n))r[e]=t/s;const i={$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"};for(const[e,t]of Object.entries(i))t in r&&(r[e]=r[t]);return r}catch(e){throw new Error("Failed to load currency conversions")}},t.getYtCurrencyMap=n,t.currencyCodeFromYtLabel=function(e){const t={$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"};return e in t?t[e]:e.match(/^[A-Z]{3}$/)?e:"???"}},522:function(e){e.exports=function(){"use strict";var e,t,n=1e3,s=6e4,r=36e5,i=864e5,a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:o,months:u,days:i,hours:r,minutes:s,seconds:n,milliseconds:1,weeks:6048e5},h=function(e){return e instanceof y},d=function(e,t,n){return new y(e,n,t.$l)},m=function(e){return t.p(e)+"s"},f=function(e){return e<0},p=function(e){return f(e)?Math.ceil(e):Math.floor(e)},g=function(e){return Math.abs(e)},M=function(e,t){return e?f(e)?{negative:!0,format:""+g(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},y=function(){function f(e,t,n){var s=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return d(e*l[m(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){s.$d[m(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var r=e.match(c);if(r){var i=r.slice(2).map(function(e){return null!=e?Number(e):0});return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var g=f.prototype;return g.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,n){return t+(e.$d[n]||0)*l[n]},0)},g.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=p(e/o),e%=o,this.$d.months=p(e/u),e%=u,this.$d.days=p(e/i),e%=i,this.$d.hours=p(e/r),e%=r,this.$d.minutes=p(e/s),e%=s,this.$d.seconds=p(e/n),e%=n,this.$d.milliseconds=e},g.toISOString=function(){var e=M(this.$d.years,"Y"),t=M(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var s=M(n,"D"),r=M(this.$d.hours,"H"),i=M(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3,a=Math.round(1e3*a)/1e3);var o=M(a,"S"),u=e.negative||t.negative||s.negative||r.negative||i.negative||o.negative,c=r.format||i.format||o.format?"T":"",l=(u?"-":"")+"P"+e.format+t.format+s.format+c+r.format+i.format+o.format;return"P"===l||"-P"===l?"P0D":l},g.toJSON=function(){return this.toISOString()},g.format=function(e){var n=e||"YYYY-MM-DDTHH:mm:ss",s={Y:this.$d.years,YY:t.s(this.$d.years,2,"0"),YYYY:t.s(this.$d.years,4,"0"),M:this.$d.months,MM:t.s(this.$d.months,2,"0"),D:this.$d.days,DD:t.s(this.$d.days,2,"0"),H:this.$d.hours,HH:t.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:t.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:t.s(this.$d.seconds,2,"0"),SSS:t.s(this.$d.milliseconds,3,"0")};return n.replace(a,function(e,t){return t||String(s[e])})},g.as=function(e){return this.$ms/l[m(e)]},g.get=function(e){var t=this.$ms,n=m(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?p(t/l[n]):this.$d[n],t||0},g.add=function(e,t,n){var s;return s=t?e*l[m(t)]:h(e)?e.$ms:d(e,this).$ms,d(this.$ms+s*(n?-1:1),this)},g.subtract=function(e,t){return this.add(e,t,!0)},g.locale=function(e){var t=this.clone();return t.$l=e,t},g.clone=function(){return d(this.$ms,this)},g.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},g.valueOf=function(){return this.asMilliseconds()},g.milliseconds=function(){return this.get("milliseconds")},g.asMilliseconds=function(){return this.as("milliseconds")},g.seconds=function(){return this.get("seconds")},g.asSeconds=function(){return this.as("seconds")},g.minutes=function(){return this.get("minutes")},g.asMinutes=function(){return this.as("minutes")},g.hours=function(){return this.get("hours")},g.asHours=function(){return this.as("hours")},g.days=function(){return this.get("days")},g.asDays=function(){return this.as("days")},g.weeks=function(){return this.get("weeks")},g.asWeeks=function(){return this.as("weeks")},g.months=function(){return this.get("months")},g.asMonths=function(){return this.as("months")},g.years=function(){return this.get("years")},g.asYears=function(){return this.as("years")},f}(),$=function(e,t,n){return e.add(t.years()*n,"y").add(t.months()*n,"M").add(t.days()*n,"d").add(t.hours()*n,"h").add(t.minutes()*n,"m").add(t.seconds()*n,"s").add(t.milliseconds()*n,"ms")};return function(n,s,r){e=r,t=r().$utils(),r.duration=function(e,t){var n=r.locale();return d(e,{$l:n},t)},r.isDuration=h;var i=s.prototype.add,a=s.prototype.subtract;s.prototype.add=function(e,t){return h(e)?$(this,e,1):i.bind(this)(e,t)},s.prototype.subtract=function(e,t){return h(e)?$(this,e,-1):a.bind(this)(e,t)}}}()},725:(e,t)=>{"use strict";function n(e){const t=document.getElementById("error");t&&(t.className=e.length?"show":"",t.innerHTML=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setErrorMsg=n,t.clearErrorMsg=function(){n("")}}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}(()=>{"use strict";const e=n(725),t=n(171),s=n(337),r=n(477),i={loadedFile:"",allChats:[],filteredChats:[],activeFilter:!1,currentPage:1,limitPerPage:1500,currencyMap:(0,r.getYtCurrencyMap)(),currencyConversions:{},allRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},filteredRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},userStats:{},aggregateStats:{chatsPerUser:0,pctMembers:0,pctMemberChats:0}};function a(e){return e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function o(e){return Math.round(100*e)/100}function u(e,t,n){const s=document.createElement("div");return s.className="stats-row",s.innerHTML=`<span class="label">${e}</span><span class="value all">${t}</span><span class="value filtered">${n}</span>`,s}function c(e){const t={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}};for(const n of e)t.numChatMessages++,n.isMember?t.numMemberChats++:t.numGreyChats++,n.isMod&&t.numModChats++,n.isOwner&&t.numOwnerChats++,n.isMembershipJoin&&t.numMembershipJoins++,n.isMembershipMessage&&t.numMilestoneMessages++,n.isMembershipRedemption&&t.totalGiftsRedeemed++,n.isMembershipGift&&(t.numGiftPurchases++,t.totalGiftsPurchased+=n.numGiftsPurchased),(n.isSuperChat||n.isSuperSticker)&&(n.isSuperChat&&t.numSuperchats++,n.isSuperSticker&&t.numSuperStickers++,t.colourTotals[n.superColour]||(t.colourTotals[n.superColour]=0),t.colourTotals[n.superColour]++,t.currencyTotals[n.superCurrency]||(t.currencyTotals[n.superCurrency]=0),t.currencyTotals[n.superCurrency]+=n.superValue);return t}function l(){const e=document.getElementById("stats");if(!e)throw new Error("Stats dialog not found");const t=document.getElementById("general-stats-body");if(!t)throw new Error("General stats body not found");const n=document.getElementById("monetization-stats-body");if(!n)throw new Error("Monetization stats body not found");const s=document.getElementById("currency-stats-body");if(!s)throw new Error("Currency stats body not found");i.activeFilter?(e.classList.add("filtered"),e.classList.remove("unfiltered")):(e.classList.add("unfiltered"),e.classList.remove("filtered"));const c=i.allRunningStats,l=i.filteredRunningStats;t.innerHTML="",n.innerHTML="",s.innerHTML="";const h=[["Total Messages",c.numChatMessages,l.numChatMessages],["Member Chats",c.numMemberChats,l.numMemberChats],["Non-Member Chats",c.numGreyChats,l.numGreyChats],["Moderator Chats",c.numModChats,l.numModChats],["Owner Chats",c.numOwnerChats,l.numOwnerChats],["Membership Joins",c.numMembershipJoins,l.numMembershipJoins],["Milestone Messages",c.numMilestoneMessages,l.numMilestoneMessages]],d=[["Number of Member Gifts",c.numGiftPurchases,l.numGiftPurchases],["Total Memberships Gifted",c.totalGiftsPurchased,l.totalGiftsPurchased],["Total Super Chats",c.numSuperchats,l.numSuperchats],["Total Super Stickers",c.numSuperStickers,l.numSuperStickers]];for(const[e,t]of Object.entries(c.colourTotals)){const n=l.colourTotals[e]||0;d.push([`${a(e)} SC / SS`,t,n])}let m=0,f=0;const p=[["Estimated Total in USD*",0,0]];for(const[e,t]of Object.entries(c.currencyTotals)){const n=(0,r.currencyCodeFromYtLabel)(e),s=n!==e?`${e} <span class="real-currency">(${n})</span>`:e,a=l.currencyTotals[e]||0;if(p.push([`${s}`,o(t),o(a)]),i.currencyConversions&&e in i.currencyConversions){const n=i.currencyConversions[e];m+=t*n,f+=a*n}}p[0][1]=o(m),p[0][2]=o(f);for(const[e,n,s]of h)t.appendChild(u(e,n,s));for(const[e,t,s]of d)n.appendChild(u(e,t,s));for(const[e,t,n]of p)s.appendChild(u(e,t,n))}function h(e){e.preventDefault();const t=document.getElementById("filter-type");if(!(t&&t instanceof HTMLSelectElement))throw new Error("Filter type dropdown not found");const n=document.getElementById("search-text");if(!(n&&n instanceof HTMLInputElement))throw new Error("Search text box not found");if(""===t.value&&""===n.value.trim())return console.log("no filter"),i.activeFilter=!1,i.filteredChats=i.allChats.slice(),i.currentPage=1,i.filteredRunningStats=i.allRunningStats,l(),void d();const s=n.value.toLowerCase();i.filteredChats=i.allChats.filter(e=>!("moderators"===t.value&&!e.isMod&&!e.isOwner)&&!!("monetized"!==t.value||e.isSuperChat||e.isSuperSticker||e.isMembershipGift||e.isMembershipRedemption||e.isMembershipMessage)&&(""===s||e.textContent.toLowerCase().includes(s)||e.userName.toLowerCase().includes(s))),i.activeFilter=!0,i.currentPage=1,i.filteredRunningStats=c(i.filteredChats),l(),d()}function d(){const e=document.getElementById("chat");if(!e)return;e.innerHTML="",scrollTo(0,0);const t=(i.currentPage-1)*i.limitPerPage,n=t+i.limitPerPage;for(let s=t;s<n&&s<i.filteredChats.length;s++){const t=document.createElement("div");t.className="item",t.innerHTML=i.filteredChats[s].htmlLine,e.appendChild(t)}!function(){const e=document.getElementById("page-indicator");e&&(e.textContent=`Page ${i.currentPage}/${m()}`)}()}function m(){return Math.ceil(i.filteredChats.length/i.limitPerPage)}function f(e){e>0&&i.currentPage>=m()||e<0&&i.currentPage<=1||(i.currentPage+=e,d())}function p(){f(-1)}function g(){f(1)}(async()=>{const n=document.getElementById("json-file");if(!(n&&n instanceof HTMLInputElement))throw new Error("File element not found");const a=document.getElementById("prev-page");if(!(a&&a instanceof HTMLButtonElement))throw new Error("Prev page button not found");a.addEventListener("click",p,!1);const o=document.getElementById("next-page");if(!(o&&o instanceof HTMLButtonElement))throw new Error("Next page button not found");o.addEventListener("click",g,!1);const u=document.getElementById("filter-form");if(!(u&&u instanceof HTMLFormElement))throw new Error("Filters form not found");u.addEventListener("submit",h,!1);const m=document.getElementById("view-stats");if(!(m&&m instanceof HTMLButtonElement))throw new Error("View stats button not found");const f=document.getElementById("stats");if(!f)throw new Error("Stats dialog not found");const M=document.getElementById("stats-shade");if(!M)throw new Error("Stats shade not found");const y=document.getElementById("close-stats");if(!(y&&y instanceof HTMLButtonElement))throw new Error("Close stats button not found");m.addEventListener("click",()=>{"block"===f.style.display?(f.style.display="none",M.style.display="none"):(f.style.display="block",M.style.display="block")},!1),M.addEventListener("click",()=>{f.style.display="none",M.style.display="none"},!1),y.addEventListener("click",()=>{f.style.display="none",M.style.display="none"},!1),n.addEventListener("change",()=>{if(function(){i.loadedFile="",i.allChats=[],i.filteredChats=[],i.activeFilter=!1,i.currentPage=1,i.allRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},i.filteredRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},i.userStats={},i.aggregateStats={chatsPerUser:0,pctMembers:0,pctMemberChats:0};const e=document.getElementById("chat");e&&(e.innerHTML="")}(),(0,e.clearErrorMsg)(),!n.files||!n.files.length)return;const r=n.files[0];if("application/json"!==r.type)return(0,e.setErrorMsg)("Error: Please choose a JSON file");(async function(e){const n=e.stream().pipeThrough(new TextDecoderStream).pipeThrough((0,t.getChunksToLinesTransform)()).getReader();for(;;){const{done:e,value:t}=await n.read();if(e||!t)break;try{const e=JSON.parse(t);(0,s.processChatMessage)(i,e)}catch(e){console.error(e)}}i.filteredChats=i.allChats.slice()})(r).then(()=>{d(),i.allRunningStats=c(i.allChats),i.filteredRunningStats=i.allRunningStats,l()})},!1),i.currencyConversions=await(0,r.loadCurrencyConversions)()})().catch(t=>{t&&(t&&"string"==typeof t.message?(0,e.setErrorMsg)(t.message):(0,e.setErrorMsg)(t.toString()))})})()})();