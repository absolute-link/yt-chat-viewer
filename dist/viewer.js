(()=>{var e={171:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChunksToLinesTransform=function(){let e="";return new TransformStream({transform:(t,n)=>{const s=e+t;e="";const r=s.split(/\r?\n/g);for(;r.length>1;)n.enqueue(r.shift());const i=r.shift();i&&(e=i)}})}},337:function(e,t,n){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processChatEvent=function(e,t){const n=t.replayChatItemAction?.actions[0];return n?.addChatItemAction?.item?function(e,t){const n=t.replayChatItemAction?.actions[0].addChatItemAction?.item;if(!n)return!1;let s,r="",i="",m="",f=!1,p=!1,g="",M="",y=0,C=!1,$=!1,b=!1,v=0,S=!1;if(n.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer){const e=n.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer,t=e.header.liveChatSponsorshipsHeaderRenderer;t.authorExternalChannelId=e.authorExternalChannelId,r=e.id,b=!0,v=parseInt((t.primaryText.runs||[])[1].text||"0"),s=l(t),m+=function(e){let t='<span class="msg membership-gift system-message">';return t+='<span class="gift-icon">üéÅ</span>',t+=`<span class="text">${u(e)}</span>`,t+="</span>",t}(t.primaryText)}else if(n.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer){const e=n.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer;r=e.id,s=l(e),m+=h(e.message,["membership-received","system-message"]),i=u(e.message||""),S=!0}else if(n.liveChatMembershipItemRenderer){const e=n.liveChatMembershipItemRenderer;r=e.id,s=l(e),e.message?(m+=function(e,t){let n='<span class="msg membership-message">';return n+=`<span class="mem-length">${function(e){return u(e).replace(/^[^0-9]+/,"").replace(/months?/,"mo").replace(/years?/,"yr")}(e)}</span>`,n+=`<span class="text">${u(t)}</span>`,n+="</span>",n}(e.headerPrimaryText,e.message),i=u(e.message),$=!0):(m+=h(e.headerSubtext,["membership-join","system-message"]),i=u(e.headerSubtext||""),C=!0)}else if(n.liveChatPaidMessageRenderer){const e=n.liveChatPaidMessageRenderer,{currencyLabel:t,amount:o}=c(e.purchaseAmountText);r=e.id,g=a(e.bodyBackgroundColor),y=o,M=t,f=!0,s=l(e),m+=function(e,t){let n=`<span class="msg superchat ${t}">`;return n+=`<span class="money">${u(e.purchaseAmountText)}</span>`,e.message&&(n+=`<span class="text">${u(e.message)}</span>`),n+="</span>",n}(e,g),i=u(e.message||"")}else if(n.liveChatPaidStickerRenderer){const e=n.liveChatPaidStickerRenderer,{currencyLabel:t,amount:i}=c(e.purchaseAmountText);r=e.id,g=a(e.backgroundColor),y=i,M=t,p=!0,s=l(e),m+=function(e,t){const n=o(e.sticker.thumbnails),s=e.sticker.accessibility.accessibilityData.label;let r=`<span class="msg super-sticker ${t}">`;return r+=`<span class="money">${u(e.purchaseAmountText)}</span>`,n&&(r+=`<img class="sticker" src="${n.url}" alt="${s}">`),r+="</span>",r}(e,g)}else{if(!n.liveChatTextMessageRenderer)return!1;{const e=n.liveChatTextMessageRenderer;r=e.id,s=l(e),m+=h(e.message),i=u(e.message||"")}}if(e.renderedChatIds.has(r))return!1;const w=t.replayChatItemAction?.videoOffsetTimeMsec||t.videoOffsetTimeMsec||"0",T=parseInt(w,10)||0,I=e.deletedChatIds.has(r),E=e.authorTimeouts.get(s.channelId||""),P=!!(E&&T<E);let D="";return D+=d(w),D+=function(e){return`<span class="${["user",...e.cssClasses].join(" ")}">\n            <a href="https://www.youtube.com/channel/${e.channelId}">${e.name}</a>\n        </span>\n    `}(s),D+=m,e.allChats.push({itemId:r,authorId:s.channelId,offsetMsec:T,isDeleted:I,isTimedOut:P,isMember:s.isMember,isMod:s.isMod,isOwner:s.isOwner,isSuperChat:f,isSuperSticker:p,superColour:g,superCurrency:M,superValue:y,isMembershipJoin:C,isMembershipMessage:$,isMembershipGift:b,numGiftsPurchased:v,isMembershipRedemption:S,isRaidBanner:!1,isPollStart:!1,isPollEnd:!1,userName:s.name,textContent:i,htmlLine:D}),e.renderedChatIds.add(r),!0}(e,t):n?.addBannerToLiveChatCommand?function(e,t){const n=t.replayChatItemAction?.actions[0].addBannerToLiveChatCommand?.bannerRenderer.liveChatBannerRenderer;if(!n)return!1;const s=n.contents.liveChatBannerRedirectRenderer;if(!s)return!1;const r=n.actionId,i=t.replayChatItemAction?.videoOffsetTimeMsec||t.videoOffsetTimeMsec||"0";if(e.renderedChatIds.has(r))return!1;let a="";return a+=d(i),a+=function(e){const t=e.inlineActionButton?.buttonRenderer.command,n=t?.watchEndpoint?.videoId?`https://www.youtube.com/watch?v=${t.watchEndpoint.videoId}`:"";let s='<span class="banner redirect-banner">';return s+=n?`<a href="${n}" target="_blank">${u(e.bannerMessage)}</a>`:u(e.bannerMessage),s+="</span>",s}(s),e.allChats.push({itemId:r,offsetMsec:parseInt(i,10)||0,isDeleted:!1,isTimedOut:!1,isMember:!1,isMod:!1,isOwner:!1,isSuperChat:!1,isSuperSticker:!1,superColour:"",superCurrency:"",superValue:0,isMembershipJoin:!1,isMembershipMessage:!1,isMembershipGift:!1,numGiftsPurchased:0,isMembershipRedemption:!1,isRaidBanner:!0,isPollStart:!1,isPollEnd:!1,userName:"",textContent:u(s.bannerMessage),htmlLine:a}),e.renderedChatIds.add(r),!0}(e,t):n?.removeChatItemAction||n?.removeChatItemByAuthorAction?function(e,t){const n=parseInt(t.videoOffsetTimeMsec||"0",10),s=t.replayChatItemAction?.actions[0].removeChatItemAction?.targetItemId,r=t.replayChatItemAction?.actions[0].removeChatItemByAuthorAction?.externalChannelId;if(!s&&!r)return!1;if(s&&e.deletedChatIds.has(s))return!0;for(const t of e.allChats)s&&t.itemId===s?t.isDeleted=!0:r&&t.authorId===r&&t.offsetMsec<=n&&(t.isDeleted=!0,t.isTimedOut=!0,e.deletedChatIds.add(t.itemId));if(s&&e.deletedChatIds.add(s),r){const t=e.authorTimeouts.get(r);(!t||t<n)&&e.authorTimeouts.set(r,n)}return!0}(e,t):n?.showLiveChatActionPanelAction||n?.updateLiveChatPollAction?function(e,t){const n=t.replayChatItemAction?.actions[0];if(!n)return!1;const s=n.showLiveChatActionPanelAction?.panelToShow.liveChatActionPanelRenderer.contents.pollRenderer||n.updateLiveChatPollAction?.pollToUpdate.pollRenderer;if(!s)return!1;const r=t.videoOffsetTimeMsec||"0",i=parseInt(r,10),a=s.liveChatPollId,o=s.header.pollHeaderRenderer,c=u(o.metadataText).match(/([0-9,]+) votes/i),l=c?parseInt(c[1].replace(/,/g,""),10):0,h=e.polls.get(a);if(h&&h.lastUpdatedMsec<=i)return h.choices=s.choices.map(e=>({text:u(e.text),percentage:100*e.voteRatio})),h.numVotes=l,h.lastUpdatedMsec=i,!0;if(h)return!1;const m={id:a,lastUpdatedMsec:i,completed:!1,question:u(o.pollQuestion),numVotes:l,choices:s.choices.map(e=>({text:u(e.text),percentage:100*e.voteRatio}))};e.polls.set(a,m);const f=s.choices.reduce((e,t)=>`${e}${u(t.text)}\n`,"");let p="";return p+=d(r),p+=function(e){let t='<span class="banner poll-start">';t+='<span class="poll-header">Poll:</span> ',t+=`<span class="poll-question">${e.question}</span>`,t+='<ul class="poll-choices">';for(const n of e.choices)t+=`<li>${n.text}</li>`;return t+="</ul>",t+="</span>",t}(m),e.allChats.push({itemId:a,offsetMsec:i,isDeleted:!1,isTimedOut:!1,isMember:!1,isMod:!1,isOwner:!1,isSuperChat:!1,isSuperSticker:!1,superColour:"",superCurrency:"",superValue:0,isMembershipJoin:!1,isMembershipMessage:!1,isMembershipGift:!1,numGiftsPurchased:0,isMembershipRedemption:!1,isRaidBanner:!1,isPollStart:!0,isPollEnd:!1,userName:"",textContent:`${u(o.pollQuestion)}\n${f}`,htmlLine:p}),!0}(e,t):!(!n?.closeLiveChatActionPanelAction&&!n?.removeBannerForLiveChatCommand)&&function(e,t){const n=t.replayChatItemAction?.actions[0];if(!n)return!1;const s=n.closeLiveChatActionPanelAction?.targetPanelId||n.removeBannerForLiveChatCommand?.targetActionId;if(!s)return!1;const r=e.polls.get(s);if(!r)return!1;if(r.completed)return!1;r.completed=!0,r.choices.sort((e,t)=>t.percentage-e.percentage);const i=t.videoOffsetTimeMsec||"0",a=parseInt(i,10),o=r.choices.reduce((e,t)=>`${e}${t.text}\n`,"");let u="";return u+=d(i),u+=function(e){let t='<span class="banner poll-end">';t+=`<span class="poll-header">Poll Complete: <span class="vote-count">${e.numVotes}</span> votes</span>`,t+=`<span class="poll-question">${e.question}</span>`,t+='<ul class="poll-choices">';for(const n of e.choices)t+=`<li>${n.text}</li>`;t+="</ul>",t+='<ul class="poll-choice-results">';for(const n of e.choices)t+=`<li><span class="vote-count">${Math.round(n.percentage/100*e.numVotes)}</span> votes (${Math.round(100*n.percentage)/100}%)</li>`;return t+="</ul>",t+="</span>",t}(r),e.allChats.push({itemId:s,offsetMsec:a,isDeleted:!1,isTimedOut:!1,isMember:!1,isMod:!1,isOwner:!1,isSuperChat:!1,isSuperSticker:!1,superColour:"",superCurrency:"",superValue:0,isMembershipJoin:!1,isMembershipMessage:!1,isMembershipGift:!1,numGiftsPurchased:0,isMembershipRedemption:!1,isRaidBanner:!1,isPollStart:!1,isPollEnd:!0,userName:"",textContent:`${r.question}\n${o}`,htmlLine:u}),!0}(e,t)};const r=s(n(353)),i=s(n(522));function a(e){const t=e.toString(),n={4279592384:"blue",4280191205:"blue",4278237396:"light-blue",4278248959:"light-blue",4278239141:"light-green",4280150454:"light-green",4294947584:"yellow",4294953512:"yellow",4293284096:"orange",4294278144:"orange",4290910299:"pink",4293467747:"pink",4291821568:"red",4293271831:"red"};return n[t]?n[t]:"unknown"}function o(e){let t=null;for(const n of e)t?(n.width||0)<(t.width||0)&&(t=n):t=n;return t}function u(e){return"string"==typeof e?e:e.simpleText?e.simpleText:e.runs?e.runs.map(e=>e.text?e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e.emoji?function(e){if(e.isCustomEmoji){const t=o(e.image.thumbnails);return t?`<img class="emoji" src="${t.url}" alt="${e.shortcuts[0]||""}">`:`<span class="emoji-text">${e.shortcuts[0]||""}</span>`}return e.emojiId}(e.emoji):"").join(""):""}function c(e){const t=u(e).match(/^([^0-9.,]*)([0-9.,]+)/);return t?{currencyLabel:(t[1]||"Unknown").trim(),amount:parseFloat(t[2].trim())}:{currencyLabel:"Unknown",amount:0}}function l(e){const t={channelId:e.authorExternalChannelId,isMember:!1,isMod:!1,isOwner:!1,cssClasses:[],name:u(e.authorName||"[Unknown Name]")};for(const n of e.authorBadges||[]){const e=n.liveChatAuthorBadgeRenderer.tooltip.toLowerCase();"owner"===e?(t.isOwner=!0,t.cssClasses.push("owner")):"moderator"===e?(t.isMod=!0,t.cssClasses.push("mod")):(e.startsWith("member")||"new member"===e)&&(t.isMember=!0,t.cssClasses.push("mem"))}return t}function d(e){const t=parseInt(e,10)||0,n=t<0?"-":"",s=Math.abs(t),i=s>36e5?"H:mm:ss":"mm:ss";return`<span class="time offset">${n}${r.default.duration(s).format(i)}</span>`}function h(e,t=[]){const n=e?u(e):"";return`<span class="${["msg",...t].join(" ")}">${n}</span>`}r.default.extend(i.default)},353:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",s="second",r="minute",i="hour",a="day",o="week",u="month",c="quarter",l="year",d="date",h="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},g=function(e,t,n){var s=String(e);return!s||s.length>=t?e:""+Array(t+1-s.length).join(n)+e},M={s:g,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),s=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+g(s,2,"0")+":"+g(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var s=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(s,u),i=n-r<0,a=t.clone().add(s+(i?-1:1),u);return+(-(s+(n-r)/(i?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:l,w:o,d:a,D:d,h:i,m:r,s,ms:n,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",C={};C[y]=p;var $="$isDayjsObject",b=function(e){return e instanceof T||!(!e||!e[$])},v=function e(t,n,s){var r;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();C[i]&&(r=i),n&&(C[i]=n,r=i);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var o=t.name;C[o]=t,r=o}return!s&&r&&(y=r),r||!s&&y},S=function(e,t){if(b(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new T(n)},w=M;w.l=v,w.i=b,w.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var T=function(){function p(e){this.$L=v(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[$]=!0}var g=p.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var s=t.match(m);if(s){var r=s[2]-1||0,i=(s[7]||"0").substring(0,3);return n?new Date(Date.UTC(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)):new Date(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,i)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return w},g.isValid=function(){return!(this.$d.toString()===h)},g.isSame=function(e,t){var n=S(e);return this.startOf(t)<=n&&n<=this.endOf(t)},g.isAfter=function(e,t){return S(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<S(e)},g.$g=function(e,t,n){return w.u(e)?this[t]:this.set(n,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var n=this,c=!!w.u(t)||t,h=w.p(e),m=function(e,t){var s=w.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return c?s:s.endOf(a)},f=function(e,t){return w.w(n.toDate()[e].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,g=this.$M,M=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case l:return c?m(1,0):m(31,11);case u:return c?m(1,g):m(0,g+1);case o:var C=this.$locale().weekStart||0,$=(p<C?p+7:p)-C;return m(c?M-$:M+(6-$),g);case a:case d:return f(y+"Hours",0);case i:return f(y+"Minutes",1);case r:return f(y+"Seconds",2);case s:return f(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var o,c=w.p(e),h="set"+(this.$u?"UTC":""),m=(o={},o[a]=h+"Date",o[d]=h+"Date",o[u]=h+"Month",o[l]=h+"FullYear",o[i]=h+"Hours",o[r]=h+"Minutes",o[s]=h+"Seconds",o[n]=h+"Milliseconds",o)[c],f=c===a?this.$D+(t-this.$W):t;if(c===u||c===l){var p=this.clone().set(d,1);p.$d[m](f),p.init(),this.$d=p.set(d,Math.min(this.$D,p.daysInMonth())).$d}else m&&this.$d[m](f);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[w.p(e)]()},g.add=function(n,c){var d,h=this;n=Number(n);var m=w.p(c),f=function(e){var t=S(h);return w.w(t.date(t.date()+Math.round(e*n)),h)};if(m===u)return this.set(u,this.$M+n);if(m===l)return this.set(l,this.$y+n);if(m===a)return f(1);if(m===o)return f(7);var p=(d={},d[r]=e,d[i]=t,d[s]=1e3,d)[m]||1,g=this.$d.getTime()+n*p;return w.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var s=e||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),i=this.$H,a=this.$m,o=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,d=function(e,n,r,i){return e&&(e[n]||e(t,s))||r[n].slice(0,i)},m=function(e){return w.s(i%12||12,e,"0")},p=l||function(e,t,n){var s=e<12?"AM":"PM";return n?s.toLowerCase():s};return s.replace(f,function(e,s){return s||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return o+1;case"MM":return w.s(o+1,2,"0");case"MMM":return d(n.monthsShort,o,c,3);case"MMMM":return d(c,o);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,u,2);case"ddd":return d(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return w.s(i,2,"0");case"h":return m(1);case"hh":return m(2);case"a":return p(i,a,!0);case"A":return p(i,a,!1);case"m":return String(a);case"mm":return w.s(a,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")})},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,d,h){var m,f=this,p=w.p(d),g=S(n),M=(g.utcOffset()-this.utcOffset())*e,y=this-g,C=function(){return w.m(f,g)};switch(p){case l:m=C()/12;break;case u:m=C();break;case c:m=C()/3;break;case o:m=(y-M)/6048e5;break;case a:m=(y-M)/864e5;break;case i:m=y/t;break;case r:m=y/e;break;case s:m=y/1e3;break;default:m=y}return h?m:w.a(m)},g.daysInMonth=function(){return this.endOf(u).$D},g.$locale=function(){return C[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),s=v(e,t,!0);return s&&(n.$L=s),n},g.clone=function(){return w.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},p}(),I=T.prototype;return S.prototype=I,[["$ms",n],["$s",s],["$m",r],["$H",i],["$W",a],["$M",u],["$y",l],["$D",d]].forEach(function(e){I[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),S.extend=function(e,t){return e.$i||(e(t,T,S),e.$i=!0),S},S.locale=v,S.isDayjs=b,S.unix=function(e){return S(1e3*e)},S.en=C[y],S.Ls=C,S.p={},S}()},477:(e,t)=>{"use strict";function n(){return{$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadCurrencyConversions=async function(){try{const e=await fetch("https://bcd-api-dca-ipa.cbsa-asfc.cloud-nuage.canada.ca/exchange-rate-lambda/exchange-rates"),t=await e.json(),n={};if(t.ForeignExchangeRates.forEach(e=>{if("CAD"!==e.ToCurrency.Value)return;const t=e.FromCurrency.Value,s=parseFloat(e.Rate);isNaN(s)||(n[t]=s)}),!("USD"in n))throw new Error("USD to CAD rate not found");const s=n.USD,r={};for(const[e,t]of Object.entries(n))r[e]=t/s;const i={$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"};for(const[e,t]of Object.entries(i))t in r&&(r[e]=r[t]);return r}catch(e){throw new Error("Failed to load currency conversions")}},t.getYtCurrencyMap=n,t.currencyCodeFromYtLabel=function(e){const t={$:"USD",CA$:"CAD",A$:"AUD",HK$:"HKD",R$:"BRL",NT$:"TWD",MX$:"MXN","‚Ç¨":"EUR","¬£":"GBP","¬•":"JPY","‚Ç±":"PHP","‚Ç©":"KRW"};return e in t?t[e]:e.match(/^[A-Z]{3}$/)?e:"???"}},522:function(e){e.exports=function(){"use strict";var e,t,n=1e3,s=6e4,r=36e5,i=864e5,a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:o,months:u,days:i,hours:r,minutes:s,seconds:n,milliseconds:1,weeks:6048e5},d=function(e){return e instanceof y},h=function(e,t,n){return new y(e,n,t.$l)},m=function(e){return t.p(e)+"s"},f=function(e){return e<0},p=function(e){return f(e)?Math.ceil(e):Math.floor(e)},g=function(e){return Math.abs(e)},M=function(e,t){return e?f(e)?{negative:!0,format:""+g(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},y=function(){function f(e,t,n){var s=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return h(e*l[m(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){s.$d[m(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var r=e.match(c);if(r){var i=r.slice(2).map(function(e){return null!=e?Number(e):0});return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var g=f.prototype;return g.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,n){return t+(e.$d[n]||0)*l[n]},0)},g.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=p(e/o),e%=o,this.$d.months=p(e/u),e%=u,this.$d.days=p(e/i),e%=i,this.$d.hours=p(e/r),e%=r,this.$d.minutes=p(e/s),e%=s,this.$d.seconds=p(e/n),e%=n,this.$d.milliseconds=e},g.toISOString=function(){var e=M(this.$d.years,"Y"),t=M(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var s=M(n,"D"),r=M(this.$d.hours,"H"),i=M(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3,a=Math.round(1e3*a)/1e3);var o=M(a,"S"),u=e.negative||t.negative||s.negative||r.negative||i.negative||o.negative,c=r.format||i.format||o.format?"T":"",l=(u?"-":"")+"P"+e.format+t.format+s.format+c+r.format+i.format+o.format;return"P"===l||"-P"===l?"P0D":l},g.toJSON=function(){return this.toISOString()},g.format=function(e){var n=e||"YYYY-MM-DDTHH:mm:ss",s={Y:this.$d.years,YY:t.s(this.$d.years,2,"0"),YYYY:t.s(this.$d.years,4,"0"),M:this.$d.months,MM:t.s(this.$d.months,2,"0"),D:this.$d.days,DD:t.s(this.$d.days,2,"0"),H:this.$d.hours,HH:t.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:t.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:t.s(this.$d.seconds,2,"0"),SSS:t.s(this.$d.milliseconds,3,"0")};return n.replace(a,function(e,t){return t||String(s[e])})},g.as=function(e){return this.$ms/l[m(e)]},g.get=function(e){var t=this.$ms,n=m(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?p(t/l[n]):this.$d[n],t||0},g.add=function(e,t,n){var s;return s=t?e*l[m(t)]:d(e)?e.$ms:h(e,this).$ms,h(this.$ms+s*(n?-1:1),this)},g.subtract=function(e,t){return this.add(e,t,!0)},g.locale=function(e){var t=this.clone();return t.$l=e,t},g.clone=function(){return h(this.$ms,this)},g.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},g.valueOf=function(){return this.asMilliseconds()},g.milliseconds=function(){return this.get("milliseconds")},g.asMilliseconds=function(){return this.as("milliseconds")},g.seconds=function(){return this.get("seconds")},g.asSeconds=function(){return this.as("seconds")},g.minutes=function(){return this.get("minutes")},g.asMinutes=function(){return this.as("minutes")},g.hours=function(){return this.get("hours")},g.asHours=function(){return this.as("hours")},g.days=function(){return this.get("days")},g.asDays=function(){return this.as("days")},g.weeks=function(){return this.get("weeks")},g.asWeeks=function(){return this.as("weeks")},g.months=function(){return this.get("months")},g.asMonths=function(){return this.as("months")},g.years=function(){return this.get("years")},g.asYears=function(){return this.as("years")},f}(),C=function(e,t,n){return e.add(t.years()*n,"y").add(t.months()*n,"M").add(t.days()*n,"d").add(t.hours()*n,"h").add(t.minutes()*n,"m").add(t.seconds()*n,"s").add(t.milliseconds()*n,"ms")};return function(n,s,r){e=r,t=r().$utils(),r.duration=function(e,t){var n=r.locale();return h(e,{$l:n},t)},r.isDuration=d;var i=s.prototype.add,a=s.prototype.subtract;s.prototype.add=function(e,t){return d(e)?C(this,e,1):i.bind(this)(e,t)},s.prototype.subtract=function(e,t){return d(e)?C(this,e,-1):a.bind(this)(e,t)}}}()},725:(e,t)=>{"use strict";function n(e){const t=document.getElementById("error");t&&(t.className=e.length?"show":"",t.innerHTML=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setErrorMsg=n,t.clearErrorMsg=function(){n("")}}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}(()=>{"use strict";const e=n(725),t=n(171),s=n(337),r=n(477),i={loadedFile:"",allChats:[],filteredChats:[],renderedChatIds:new Set,deletedChatIds:new Set,authorTimeouts:new Map,polls:new Map,activeFilter:!1,currentPage:1,limitPerPage:1500,currencyMap:(0,r.getYtCurrencyMap)(),currenciesLoaded:!1,currencyConversions:{},allRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},filteredRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},userStats:{},aggregateStats:{chatsPerUser:0,pctMembers:0,pctMemberChats:0}};function a(e){return e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function o(e){return Math.round(100*e)/100}function u(e,t,n){const s=document.createElement("div");return s.className="stats-row",s.innerHTML=`<span class="label">${e}</span><span class="value all">${t}</span><span class="value filtered">${n}</span>`,s}function c(e){const t={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}};for(const n of e)t.numChatMessages++,n.isMember?t.numMemberChats++:t.numGreyChats++,n.isMod&&t.numModChats++,n.isOwner&&t.numOwnerChats++,n.isMembershipJoin&&t.numMembershipJoins++,n.isMembershipMessage&&t.numMilestoneMessages++,n.isMembershipRedemption&&t.totalGiftsRedeemed++,n.isMembershipGift&&(t.numGiftPurchases++,t.totalGiftsPurchased+=n.numGiftsPurchased),(n.isSuperChat||n.isSuperSticker)&&(n.isSuperChat&&t.numSuperchats++,n.isSuperSticker&&t.numSuperStickers++,t.colourTotals[n.superColour]||(t.colourTotals[n.superColour]=0),t.colourTotals[n.superColour]++,t.currencyTotals[n.superCurrency]||(t.currencyTotals[n.superCurrency]=0),t.currencyTotals[n.superCurrency]+=n.superValue);return t}function l(){const e=document.getElementById("stats");if(!e)throw new Error("Stats dialog not found");const t=document.getElementById("general-stats-body");if(!t)throw new Error("General stats body not found");const n=document.getElementById("monetization-stats-body");if(!n)throw new Error("Monetization stats body not found");const s=document.getElementById("currency-stats-body");if(!s)throw new Error("Currency stats body not found");const c=document.getElementById("estimate-usd-all"),l=document.getElementById("estimate-usd-filtered");if(!c||!l)throw new Error("USD estimate spans not found");i.activeFilter?(e.classList.add("filtered"),e.classList.remove("unfiltered")):(e.classList.add("unfiltered"),e.classList.remove("filtered"));const d=i.allRunningStats,h=i.filteredRunningStats;t.innerHTML="",n.innerHTML="",s.innerHTML="";const m=[["Total Messages",d.numChatMessages,h.numChatMessages],["Member Chats",d.numMemberChats,h.numMemberChats],["Non-Member Chats",d.numGreyChats,h.numGreyChats],["Moderator Chats",d.numModChats,h.numModChats],["Owner Chats",d.numOwnerChats,h.numOwnerChats],["Membership Joins",d.numMembershipJoins,h.numMembershipJoins],["Milestone Messages",d.numMilestoneMessages,h.numMilestoneMessages]],f=[["Number of Member Gifts",d.numGiftPurchases,h.numGiftPurchases],["Total Memberships Gifted",d.totalGiftsPurchased,h.totalGiftsPurchased],["Membership Gifts Redeemed",d.totalGiftsRedeemed,h.totalGiftsRedeemed],["Total Super Chats",d.numSuperchats,h.numSuperchats],["Total Super Stickers",d.numSuperStickers,h.numSuperStickers]];for(const[e,t]of Object.entries(d.colourTotals)){const n=h.colourTotals[e]||0;f.push([`${a(e)} SC / SS`,t,n])}let p=0,g=0;const M=[];for(const[e,t]of Object.entries(d.currencyTotals)){const n=(0,r.currencyCodeFromYtLabel)(e),s=n!==e?`${e} <span class="real-currency">(${n})</span>`:e,a=h.currencyTotals[e]||0;if(M.push([`${s}`,o(t),o(a)]),i.currenciesLoaded&&i.currencyConversions&&e in i.currencyConversions){const n=i.currencyConversions[e];p+=t*n,g+=a*n}}for(const[e,n,s]of m)t.appendChild(u(e,n,s));for(const[e,t,s]of f)n.appendChild(u(e,t,s));i.currenciesLoaded&&(c.textContent=o(p).toString(),l.textContent=o(g).toString());for(const[e,t,n]of M)s.appendChild(u(e,t,n))}function d(e){e.preventDefault();const t=document.getElementById("filter-type");if(!(t&&t instanceof HTMLSelectElement))throw new Error("Filter type dropdown not found");const n=document.getElementById("search-text");if(!(n&&n instanceof HTMLInputElement))throw new Error("Search text box not found");if(""===t.value&&""===n.value.trim())return console.log("no filter"),i.activeFilter=!1,i.filteredChats=i.allChats.slice(),i.currentPage=1,i.filteredRunningStats=i.allRunningStats,l(),void h();const s=n.value.toLowerCase();i.filteredChats=i.allChats.filter(e=>!("moderators"===t.value&&!e.isMod&&!e.isOwner)&&!!("monetized"!==t.value||e.isSuperChat||e.isSuperSticker||e.isMembershipJoin||e.isMembershipGift||e.isMembershipRedemption||e.isMembershipMessage)&&!("supers"===t.value&&!e.isSuperChat&&!e.isSuperSticker)&&!!("memberships"!==t.value||e.isMembershipJoin||e.isMembershipGift||e.isMembershipRedemption||e.isMembershipMessage)&&!!("events"!==t.value||e.isRaidBanner||e.isPollStart||e.isPollEnd)&&!("removed"===t.value&&!e.isDeleted&&!e.isTimedOut)&&(""===s||e.textContent.toLowerCase().includes(s)||e.userName.toLowerCase().includes(s))),i.activeFilter=!0,i.currentPage=1,i.filteredRunningStats=c(i.filteredChats),l(),h()}function h(){const e=document.getElementById("chat");if(!e)return;e.innerHTML="",scrollTo(0,0);const t=(i.currentPage-1)*i.limitPerPage,n=t+i.limitPerPage;for(let s=t;s<n&&s<i.filteredChats.length;s++){const t=document.createElement("div");t.className="item",i.filteredChats[s].isDeleted&&(t.className+=" deleted"),i.filteredChats[s].isTimedOut&&(t.className+=" timeout"),t.innerHTML=i.filteredChats[s].htmlLine,e.appendChild(t)}!function(){const e=document.getElementById("page-indicator");e&&(e.textContent=`Page ${i.currentPage}/${m()}`)}()}function m(){return Math.ceil(i.filteredChats.length/i.limitPerPage)}function f(e){e>0&&i.currentPage>=m()||e<0&&i.currentPage<=1||(i.currentPage+=e,h())}function p(){f(-1)}function g(){f(1)}async function M(e){const n=e.stream().pipeThrough(new TextDecoderStream).pipeThrough((0,t.getChunksToLinesTransform)()).getReader();for(;;){const{done:e,value:t}=await n.read();if(e||!t)break;try{const e=JSON.parse(t);(0,s.processChatEvent)(i,e)}catch(e){console.error(e)}}i.allChats.sort((e,t)=>e.offsetMsec-t.offsetMsec),i.filteredChats=i.allChats.slice()}(async()=>{const t=document.getElementById("loading-icon");if(!t)throw new Error("Loading icon element not found");const n=document.getElementById("json-file");if(!(n&&n instanceof HTMLInputElement))throw new Error("File element not found");const s=document.getElementById("url-display");if(!s)throw new Error("URL display element not found");const a=document.getElementById("prev-page");if(!(a&&a instanceof HTMLButtonElement))throw new Error("Prev page button not found");a.addEventListener("click",p,!1);const o=document.getElementById("next-page");if(!(o&&o instanceof HTMLButtonElement))throw new Error("Next page button not found");o.addEventListener("click",g,!1);const u=document.getElementById("filter-form");if(!(u&&u instanceof HTMLFormElement))throw new Error("Filters form not found");u.addEventListener("submit",d,!1);const m=document.getElementById("view-stats");if(!(m&&m instanceof HTMLButtonElement))throw new Error("View stats button not found");const f=document.getElementById("stats");if(!f)throw new Error("Stats dialog not found");const y=document.getElementById("stats-shade");if(!y)throw new Error("Stats shade not found");const C=document.getElementById("close-stats");if(!(C&&C instanceof HTMLButtonElement))throw new Error("Close stats button not found");const $=document.getElementById("load-currencies");if(!($&&$ instanceof HTMLButtonElement))throw new Error("Load currencies button not found");if(l(),m.addEventListener("click",()=>{"block"===f.style.display?(f.style.display="none",y.style.display="none"):(f.style.display="block",y.style.display="block",scrollTo(0,0))},!1),y.addEventListener("click",()=>{f.style.display="none",y.style.display="none"},!1),C.addEventListener("click",()=>{f.style.display="none",y.style.display="none"},!1),$.addEventListener("click",async()=>{if(i.currenciesLoaded)return;const e=document.getElementById("estimate-usd-all"),t=document.getElementById("estimate-usd-filtered");if(!e||!t)throw new Error("USD estimate spans not found");e.innerHTML="‚Ä¢‚Ä¢‚Ä¢",t.innerHTML="‚Ä¢‚Ä¢‚Ä¢",i.currencyConversions=await(0,r.loadCurrencyConversions)(),i.currenciesLoaded=!0,l()},!1),n.addEventListener("change",async()=>{if(function(){i.loadedFile="",i.allChats=[],i.filteredChats=[],i.renderedChatIds.clear(),i.deletedChatIds.clear(),i.authorTimeouts.clear(),i.polls.clear(),i.activeFilter=!1,i.currentPage=1,i.allRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},i.filteredRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},i.userStats={},i.aggregateStats={chatsPerUser:0,pctMembers:0,pctMemberChats:0};const e=document.getElementById("chat");e&&(e.innerHTML="")}(),(0,e.clearErrorMsg)(),!n.files||!n.files.length)return;const s=n.files[0];if("application/json"!==s.type)return(0,e.setErrorMsg)("Error: Please choose a JSON file");t.style.display="block",await M(s),t.style.display="none",h(),i.allRunningStats=c(i.allChats),i.filteredRunningStats=i.allRunningStats,l()},!1),window.location.search){const e=new URLSearchParams(window.location.search).get("chatFile");if(e){n.style.display="none",s.style.display="block",s.textContent=`Chat File: ${e}`,t.style.display="block";const r=await fetch(e);if(!r.ok)throw new Error("Failed to load chat file from URL");const a=await r.blob();if("application/json"!==a.type)throw new Error("Error: Please provide a JSON file");await M(new File([a],"chat.json",{type:"application/json"})),t.style.display="none",h(),i.allRunningStats=c(i.allChats),i.filteredRunningStats=i.allRunningStats,l()}}})().catch(t=>{t&&(t&&"string"==typeof t.message?(0,e.setErrorMsg)(t.message):(0,e.setErrorMsg)(t.toString()))})})()})();