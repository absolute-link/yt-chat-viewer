(()=>{var e={171:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChunksToLinesTransform=function(){let e="";return new TransformStream({transform:(t,s)=>{const n=e+t;e="";const r=n.split(/\r?\n/g);for(;r.length>1;)s.enqueue(r.shift());const i=r.shift();i&&(e=i)}})}},337:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processChatMessage=function(e,t){const s=t.replayChatItemAction?.actions[0].addChatItemAction?.item;if(!s)return!1;let n,i="",d="",m=!1,f=!1,p="",g="",M=0,y=!1,$=!1,b=!1,C=0,S=!1;if(s.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer){const e=s.liveChatSponsorshipsGiftPurchaseAnnouncementRenderer,t=e.header.liveChatSponsorshipsHeaderRenderer;t.authorExternalChannelId=e.authorExternalChannelId,b=!0,C=parseInt((t.primaryText.runs||[])[1].text||"0"),n=l(t),d+=function(e){let t='<span class="msg membership-gift system-message">';return t+='<span class="gift-icon">üéÅ</span>',t+=`<span class="text">${u(e)}</span>`,t+="</span>",t}(t.primaryText)}else if(s.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer){const e=s.liveChatSponsorshipsGiftRedemptionAnnouncementRenderer;n=l(e),d+=h(e.message,["membership-received","system-message"]),S=!0}else if(s.liveChatMembershipItemRenderer){const e=s.liveChatMembershipItemRenderer;n=l(e),e.message?(d+=function(e,t){let s='<span class="msg membership-message">';return s+=`<span class="mem-length">${function(e){return u(e).replace(/^[^0-9]+/,"").replace(/months?/,"mo").replace(/years?/,"yr")}(e)}</span>`,s+=`<span class="text">${u(t)}</span>`,s+="</span>",s}(e.headerPrimaryText,e.message),i=u(e.message),$=!0):(d+=h(e.headerSubtext,["membership-join","system-message"]),y=!0)}else if(s.liveChatPaidMessageRenderer){const e=s.liveChatPaidMessageRenderer,{currencyLabel:t,amount:r}=c(e.purchaseAmountText);p=a(e.bodyBackgroundColor),M=r,g=t,m=!0,n=l(e),d+=function(e,t){let s=`<span class="msg superchat ${t}">`;return s+=`<span class="money">${u(e.purchaseAmountText)}</span>`,e.message&&(s+=`<span class="text">${u(e.message)}</span>`),s+="</span>",s}(e,p),i=u(e.message||"")}else if(s.liveChatPaidStickerRenderer){const e=s.liveChatPaidStickerRenderer,{currencyLabel:t,amount:r}=c(e.purchaseAmountText);p=a(e.backgroundColor),M=r,g=t,f=!0,n=l(e),d+=function(e,t){const s=o(e.sticker.thumbnails),n=e.sticker.accessibility.accessibilityData.label;let r=`<span class="msg super-sticker ${t}">`;return r+=`<span class="money">${u(e.purchaseAmountText)}</span>`,s&&(r+=`<img class="sticker" src="${s.url}" alt="${n}">`),r+="</span>",r}(e,p)}else{if(!s.liveChatTextMessageRenderer)return!1;{const e=s.liveChatTextMessageRenderer;n=l(e),d+=h(e.message),i=u(e.message||"")}}let v="";return v+=function(e){const t=parseInt(e,10)||0,s=t>36e5?"H:mm:ss":"mm:ss";return`<span class="time offset">${r.default.duration(t).format(s)}</span>`}(t.replayChatItemAction?.videoOffsetTimeMsec||""),v+=function(e){return`<span class="${["user",...e.cssClasses].join(" ")}">\n            <a href="https://www.youtube.com/channel/${e.channelId}">${e.name}</a>\n        </span>\n    `}(n),v+=d,e.allChats.push({isMember:n.isMember,isMod:n.isMod,isOwner:n.isOwner,isSuperChat:m,isSuperSticker:f,superColour:p,superCurrency:g,superValue:M,isMembershipJoin:y,isMembershipMessage:$,isMembershipGift:b,numGiftsPurchased:C,isMembershipRedemption:S,userName:n.name,textContent:i,htmlLine:v}),!0};const r=n(s(353)),i=n(s(522));function a(e){const t=e.toString(),s={4279592384:"blue",4280191205:"blue",4278237396:"light-blue",4278248959:"light-blue",4278239141:"light-green",4280150454:"light-green",4294947584:"yellow",4294953512:"yellow",4293284096:"orange",4294278144:"orange",4290910299:"pink",4293467747:"pink",4291821568:"red",4293271831:"red"};return s[t]?s[t]:"unknown"}function o(e){let t=null;for(const s of e)t?(s.width||0)<(t.width||0)&&(t=s):t=s;return t}function u(e){return"string"==typeof e?e:e.simpleText?e.simpleText:e.runs?e.runs.map(e=>e.text?e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e.emoji?function(e){if(e.isCustomEmoji){const t=o(e.image.thumbnails);return t?`<img class="emoji" src="${t.url}" alt="${e.shortcuts[0]||""}">`:`<span class="emoji-text">${e.shortcuts[0]||""}</span>`}return e.emojiId}(e.emoji):"").join(""):""}function c(e){const t=u(e).match(/^([^0-9.,]*)([0-9.,]+)/);return t?{currencyLabel:(t[1]||"Unknown").trim(),amount:parseFloat(t[2].trim())}:{currencyLabel:"Unknown",amount:0}}function l(e){const t={channelId:e.authorExternalChannelId||"",isMember:!1,isMod:!1,isOwner:!1,cssClasses:[],name:u(e.authorName||"[Unknown Name]")};for(const s of e.authorBadges||[]){const e=s.liveChatAuthorBadgeRenderer.tooltip.toLowerCase();"owner"===e?(t.isOwner=!0,t.cssClasses.push("owner")):"moderator"===e?(t.isMod=!0,t.cssClasses.push("mod")):(e.startsWith("member")||"new member"===e)&&(t.isMember=!0,t.cssClasses.push("mem"))}return t}function h(e,t=[]){const s=e?u(e):"";return`<span class="${["msg",...t].join(" ")}">${s}</span>`}r.default.extend(i.default)},353:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,s="millisecond",n="second",r="minute",i="hour",a="day",o="week",u="month",c="quarter",l="year",h="date",d="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],s=e%100;return"["+e+(t[(s-20)%10]||t[s]||t[0])+"]"}},g=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},M={s:g,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),r=s%60;return(t<=0?"+":"-")+g(n,2,"0")+":"+g(r,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),r=t.clone().add(n,u),i=s-r<0,a=t.clone().add(n+(i?-1:1),u);return+(-(n+(s-r)/(i?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:l,w:o,d:a,D:h,h:i,m:r,s:n,ms:s,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",$={};$[y]=p;var b="$isDayjsObject",C=function(e){return e instanceof T||!(!e||!e[b])},S=function e(t,s,n){var r;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();$[i]&&(r=i),s&&($[i]=s,r=i);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var o=t.name;$[o]=t,r=o}return!n&&r&&(y=r),r||!n&&y},v=function(e,t){if(C(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new T(s)},w=M;w.l=S,w.i=C,w.w=function(e,t){return v(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var T=function(){function p(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var g=p.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(m);if(n){var r=n[2]-1||0,i=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return w},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(e,t){var s=v(e);return this.startOf(t)<=s&&s<=this.endOf(t)},g.isAfter=function(e,t){return v(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<v(e)},g.$g=function(e,t,s){return w.u(e)?this[t]:this.set(s,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var s=this,c=!!w.u(t)||t,d=w.p(e),m=function(e,t){var n=w.w(s.$u?Date.UTC(s.$y,t,e):new Date(s.$y,t,e),s);return c?n:n.endOf(a)},f=function(e,t){return w.w(s.toDate()[e].apply(s.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},p=this.$W,g=this.$M,M=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case l:return c?m(1,0):m(31,11);case u:return c?m(1,g):m(0,g+1);case o:var $=this.$locale().weekStart||0,b=(p<$?p+7:p)-$;return m(c?M-b:M+(6-b),g);case a:case h:return f(y+"Hours",0);case i:return f(y+"Minutes",1);case r:return f(y+"Seconds",2);case n:return f(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var o,c=w.p(e),d="set"+(this.$u?"UTC":""),m=(o={},o[a]=d+"Date",o[h]=d+"Date",o[u]=d+"Month",o[l]=d+"FullYear",o[i]=d+"Hours",o[r]=d+"Minutes",o[n]=d+"Seconds",o[s]=d+"Milliseconds",o)[c],f=c===a?this.$D+(t-this.$W):t;if(c===u||c===l){var p=this.clone().set(h,1);p.$d[m](f),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else m&&this.$d[m](f);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[w.p(e)]()},g.add=function(s,c){var h,d=this;s=Number(s);var m=w.p(c),f=function(e){var t=v(d);return w.w(t.date(t.date()+Math.round(e*s)),d)};if(m===u)return this.set(u,this.$M+s);if(m===l)return this.set(l,this.$y+s);if(m===a)return f(1);if(m===o)return f(7);var p=(h={},h[r]=e,h[i]=t,h[n]=1e3,h)[m]||1,g=this.$d.getTime()+s*p;return w.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return s.invalidDate||d;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),i=this.$H,a=this.$m,o=this.$M,u=s.weekdays,c=s.months,l=s.meridiem,h=function(e,s,r,i){return e&&(e[s]||e(t,n))||r[s].slice(0,i)},m=function(e){return w.s(i%12||12,e,"0")},p=l||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n};return n.replace(f,function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return o+1;case"MM":return w.s(o+1,2,"0");case"MMM":return h(s.monthsShort,o,c,3);case"MMMM":return h(c,o);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(s.weekdaysMin,t.$W,u,2);case"ddd":return h(s.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return w.s(i,2,"0");case"h":return m(1);case"hh":return m(2);case"a":return p(i,a,!0);case"A":return p(i,a,!1);case"m":return String(a);case"mm":return w.s(a,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")})},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(s,h,d){var m,f=this,p=w.p(h),g=v(s),M=(g.utcOffset()-this.utcOffset())*e,y=this-g,$=function(){return w.m(f,g)};switch(p){case l:m=$()/12;break;case u:m=$();break;case c:m=$()/3;break;case o:m=(y-M)/6048e5;break;case a:m=(y-M)/864e5;break;case i:m=y/t;break;case r:m=y/e;break;case n:m=y/1e3;break;default:m=y}return d?m:w.a(m)},g.daysInMonth=function(){return this.endOf(u).$D},g.$locale=function(){return $[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=S(e,t,!0);return n&&(s.$L=n),s},g.clone=function(){return w.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},p}(),k=T.prototype;return v.prototype=k,[["$ms",s],["$s",n],["$m",r],["$H",i],["$W",a],["$M",u],["$y",l],["$D",h]].forEach(function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),v.extend=function(e,t){return e.$i||(e(t,T,v),e.$i=!0),v},v.locale=S,v.isDayjs=C,v.unix=function(e){return v(1e3*e)},v.en=$[y],v.Ls=$,v.p={},v}()},522:function(e){e.exports=function(){"use strict";var e,t,s=1e3,n=6e4,r=36e5,i=864e5,a=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:o,months:u,days:i,hours:r,minutes:n,seconds:s,milliseconds:1,weeks:6048e5},h=function(e){return e instanceof y},d=function(e,t,s){return new y(e,s,t.$l)},m=function(e){return t.p(e)+"s"},f=function(e){return e<0},p=function(e){return f(e)?Math.ceil(e):Math.floor(e)},g=function(e){return Math.abs(e)},M=function(e,t){return e?f(e)?{negative:!0,format:""+g(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},y=function(){function f(e,t,s){var n=this;if(this.$d={},this.$l=s,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return d(e*l[m(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){n.$d[m(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var r=e.match(c);if(r){var i=r.slice(2).map(function(e){return null!=e?Number(e):0});return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var g=f.prototype;return g.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,s){return t+(e.$d[s]||0)*l[s]},0)},g.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=p(e/o),e%=o,this.$d.months=p(e/u),e%=u,this.$d.days=p(e/i),e%=i,this.$d.hours=p(e/r),e%=r,this.$d.minutes=p(e/n),e%=n,this.$d.seconds=p(e/s),e%=s,this.$d.milliseconds=e},g.toISOString=function(){var e=M(this.$d.years,"Y"),t=M(this.$d.months,"M"),s=+this.$d.days||0;this.$d.weeks&&(s+=7*this.$d.weeks);var n=M(s,"D"),r=M(this.$d.hours,"H"),i=M(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3,a=Math.round(1e3*a)/1e3);var o=M(a,"S"),u=e.negative||t.negative||n.negative||r.negative||i.negative||o.negative,c=r.format||i.format||o.format?"T":"",l=(u?"-":"")+"P"+e.format+t.format+n.format+c+r.format+i.format+o.format;return"P"===l||"-P"===l?"P0D":l},g.toJSON=function(){return this.toISOString()},g.format=function(e){var s=e||"YYYY-MM-DDTHH:mm:ss",n={Y:this.$d.years,YY:t.s(this.$d.years,2,"0"),YYYY:t.s(this.$d.years,4,"0"),M:this.$d.months,MM:t.s(this.$d.months,2,"0"),D:this.$d.days,DD:t.s(this.$d.days,2,"0"),H:this.$d.hours,HH:t.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:t.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:t.s(this.$d.seconds,2,"0"),SSS:t.s(this.$d.milliseconds,3,"0")};return s.replace(a,function(e,t){return t||String(n[e])})},g.as=function(e){return this.$ms/l[m(e)]},g.get=function(e){var t=this.$ms,s=m(e);return"milliseconds"===s?t%=1e3:t="weeks"===s?p(t/l[s]):this.$d[s],t||0},g.add=function(e,t,s){var n;return n=t?e*l[m(t)]:h(e)?e.$ms:d(e,this).$ms,d(this.$ms+n*(s?-1:1),this)},g.subtract=function(e,t){return this.add(e,t,!0)},g.locale=function(e){var t=this.clone();return t.$l=e,t},g.clone=function(){return d(this.$ms,this)},g.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},g.valueOf=function(){return this.asMilliseconds()},g.milliseconds=function(){return this.get("milliseconds")},g.asMilliseconds=function(){return this.as("milliseconds")},g.seconds=function(){return this.get("seconds")},g.asSeconds=function(){return this.as("seconds")},g.minutes=function(){return this.get("minutes")},g.asMinutes=function(){return this.as("minutes")},g.hours=function(){return this.get("hours")},g.asHours=function(){return this.as("hours")},g.days=function(){return this.get("days")},g.asDays=function(){return this.as("days")},g.weeks=function(){return this.get("weeks")},g.asWeeks=function(){return this.as("weeks")},g.months=function(){return this.get("months")},g.asMonths=function(){return this.as("months")},g.years=function(){return this.get("years")},g.asYears=function(){return this.as("years")},f}(),$=function(e,t,s){return e.add(t.years()*s,"y").add(t.months()*s,"M").add(t.days()*s,"d").add(t.hours()*s,"h").add(t.minutes()*s,"m").add(t.seconds()*s,"s").add(t.milliseconds()*s,"ms")};return function(s,n,r){e=r,t=r().$utils(),r.duration=function(e,t){var s=r.locale();return d(e,{$l:s},t)},r.isDuration=h;var i=n.prototype.add,a=n.prototype.subtract;n.prototype.add=function(e,t){return h(e)?$(this,e,1):i.bind(this)(e,t)},n.prototype.subtract=function(e,t){return h(e)?$(this,e,-1):a.bind(this)(e,t)}}}()},725:(e,t)=>{"use strict";function s(e){const t=document.getElementById("error");t&&(t.className=e.length?"show":"",t.innerHTML=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setErrorMsg=s,t.clearErrorMsg=function(){s("")}}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,s),i.exports}(()=>{"use strict";const e=s(725),t=s(171),n=s(337),r={loadedFile:"",allChats:[],filteredChats:[],activeFilter:!1,currentPage:1,limitPerPage:1500,allRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},filteredRunningStats:{numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},userStats:{},aggregateStats:{chatsPerUser:0,pctMembers:0,pctMemberChats:0}};function i(e){return e.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function a(e){return Math.round(100*e)/100}function o(e,t,s){const n=document.createElement("div");return n.className="stats-row",n.innerHTML=`<span class="label">${e}</span><span class="value all">${t}</span><span class="value filtered">${s}</span>`,n}function u(e){const t={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}};for(const s of e)t.numChatMessages++,s.isMember?t.numMemberChats++:t.numGreyChats++,s.isMod&&t.numModChats++,s.isOwner&&t.numOwnerChats++,s.isMembershipJoin&&t.numMembershipJoins++,s.isMembershipMessage&&t.numMilestoneMessages++,s.isMembershipRedemption&&t.totalGiftsRedeemed++,s.isMembershipGift&&(t.numGiftPurchases++,t.totalGiftsPurchased+=s.numGiftsPurchased),(s.isSuperChat||s.isSuperSticker)&&(s.isSuperChat&&t.numSuperchats++,s.isSuperSticker&&t.numSuperStickers++,t.colourTotals[s.superColour]||(t.colourTotals[s.superColour]=0),t.colourTotals[s.superColour]++,t.currencyTotals[s.superCurrency]||(t.currencyTotals[s.superCurrency]=0),t.currencyTotals[s.superCurrency]+=s.superValue);return t}function c(){const e=document.getElementById("stats");if(!e)throw new Error("Stats dialog not found");const t=document.getElementById("general-stats-body");if(!t)throw new Error("General stats body not found");const s=document.getElementById("monetization-stats-body");if(!s)throw new Error("Monetization stats body not found");const n=document.getElementById("currency-stats-body");if(!n)throw new Error("Currency stats body not found");r.activeFilter?(e.classList.add("filtered"),e.classList.remove("unfiltered")):(e.classList.add("unfiltered"),e.classList.remove("filtered"));const u=r.allRunningStats,c=r.filteredRunningStats;t.innerHTML="",s.innerHTML="",n.innerHTML="";const l=[["Total Messages",u.numChatMessages,c.numChatMessages],["Member Chats",u.numMemberChats,c.numMemberChats],["Non-Member Chats",u.numGreyChats,c.numGreyChats],["Moderator Chats",u.numModChats,c.numModChats],["Owner Chats",u.numOwnerChats,c.numOwnerChats],["Membership Joins",u.numMembershipJoins,c.numMembershipJoins],["Milestone Messages",u.numMilestoneMessages,c.numMilestoneMessages]],h=[["Number of Member Gifts",u.numGiftPurchases,c.numGiftPurchases],["Total Memberships Gifted",u.totalGiftsPurchased,c.totalGiftsPurchased],["Total Super Chats",u.numSuperchats,c.numSuperchats],["Total Super Stickers",u.numSuperStickers,c.numSuperStickers]];for(const[e,t]of Object.entries(u.colourTotals)){const s=c.colourTotals[e]||0;h.push([`${i(e)} SC / SS`,t,s])}const d=[];for(const[e,t]of Object.entries(u.currencyTotals)){const s=c.currencyTotals[e]||0;d.push([`Total ${e}`,a(t),a(s)])}for(const[e,s,n]of l)t.appendChild(o(e,s,n));for(const[e,t,n]of h)s.appendChild(o(e,t,n));for(const[e,t,s]of d)n.appendChild(o(e,t,s))}function l(e){e.preventDefault();const t=document.getElementById("filter-type");if(!(t&&t instanceof HTMLSelectElement))throw new Error("Filter type dropdown not found");const s=document.getElementById("search-text");if(!(s&&s instanceof HTMLInputElement))throw new Error("Search text box not found");if(""===t.value&&""===s.value.trim())return console.log("no filter"),r.activeFilter=!1,r.filteredChats=r.allChats.slice(),r.currentPage=1,r.filteredRunningStats=r.allRunningStats,c(),void h();const n=s.value.toLowerCase();r.filteredChats=r.allChats.filter(e=>!("moderators"===t.value&&!e.isMod&&!e.isOwner)&&!!("monetized"!==t.value||e.isSuperChat||e.isSuperSticker||e.isMembershipGift||e.isMembershipRedemption||e.isMembershipMessage)&&(""===n||e.textContent.toLowerCase().includes(n)||e.userName.toLowerCase().includes(n))),r.activeFilter=!0,r.currentPage=1,r.filteredRunningStats=u(r.filteredChats),c(),h()}function h(){const e=document.getElementById("chat");if(!e)return;e.innerHTML="",scrollTo(0,0);const t=(r.currentPage-1)*r.limitPerPage,s=t+r.limitPerPage;for(let n=t;n<s&&n<r.filteredChats.length;n++){const t=document.createElement("div");t.className="item",t.innerHTML=r.filteredChats[n].htmlLine,e.appendChild(t)}!function(){const e=document.getElementById("page-indicator");e&&(e.textContent=`Page ${r.currentPage}/${d()}`)}()}function d(){return Math.ceil(r.filteredChats.length/r.limitPerPage)}function m(e){e>0&&r.currentPage>=d()||e<0&&r.currentPage<=1||(r.currentPage+=e,h())}function f(){m(-1)}function p(){m(1)}(async()=>{const s=document.getElementById("json-file");if(!(s&&s instanceof HTMLInputElement))throw new Error("File element not found");const i=document.getElementById("prev-page");if(!(i&&i instanceof HTMLButtonElement))throw new Error("Prev page button not found");i.addEventListener("click",f,!1);const a=document.getElementById("next-page");if(!(a&&a instanceof HTMLButtonElement))throw new Error("Next page button not found");a.addEventListener("click",p,!1);const o=document.getElementById("filter-form");if(!(o&&o instanceof HTMLFormElement))throw new Error("Filters form not found");o.addEventListener("submit",l,!1);const d=document.getElementById("view-stats");if(!(d&&d instanceof HTMLButtonElement))throw new Error("View stats button not found");const m=document.getElementById("stats");if(!m)throw new Error("Stats dialog not found");const g=document.getElementById("stats-shade");if(!g)throw new Error("Stats shade not found");const M=document.getElementById("close-stats");if(!(M&&M instanceof HTMLButtonElement))throw new Error("Close stats button not found");d.addEventListener("click",()=>{"block"===m.style.display?(m.style.display="none",g.style.display="none"):(m.style.display="block",g.style.display="block")},!1),g.addEventListener("click",()=>{m.style.display="none",g.style.display="none"},!1),M.addEventListener("click",()=>{m.style.display="none",g.style.display="none"},!1),s.addEventListener("change",()=>{if(function(){r.loadedFile="",r.allChats=[],r.filteredChats=[],r.activeFilter=!1,r.currentPage=1,r.allRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},r.filteredRunningStats={numChatMessages:0,numMemberChats:0,numModChats:0,numOwnerChats:0,numGreyChats:0,numGiftPurchases:0,totalGiftsPurchased:0,totalGiftsRedeemed:0,numMembershipJoins:0,numMilestoneMessages:0,numSuperchats:0,numSuperStickers:0,colourTotals:{red:0,pink:0,orange:0,yellow:0,"light-green":0,"light-blue":0,blue:0},currencyTotals:{}},r.userStats={},r.aggregateStats={chatsPerUser:0,pctMembers:0,pctMemberChats:0};const e=document.getElementById("chat");e&&(e.innerHTML="")}(),(0,e.clearErrorMsg)(),!s.files||!s.files.length)return;const i=s.files[0];if("application/json"!==i.type)return(0,e.setErrorMsg)("Error: Please choose a JSON file");(async function(e){const s=e.stream().pipeThrough(new TextDecoderStream).pipeThrough((0,t.getChunksToLinesTransform)()).getReader();for(;;){const{done:e,value:t}=await s.read();if(e||!t)break;try{const e=JSON.parse(t);(0,n.processChatMessage)(r,e)}catch(e){console.error(e)}}r.filteredChats=r.allChats.slice()})(i).then(()=>{h(),r.allRunningStats=u(r.allChats),r.filteredRunningStats=r.allRunningStats,c()})},!1)})().catch(t=>{t&&(t&&"string"==typeof t.message?(0,e.setErrorMsg)(t.message):(0,e.setErrorMsg)(t.toString()))})})()})();